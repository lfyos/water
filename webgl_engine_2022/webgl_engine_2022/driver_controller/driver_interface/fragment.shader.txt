uniform mat4 par;
uniform sampler2D texture_sampler;

in vec4 frag_texture;

layout (location = 0) out vec4 frag_data[4];

void main(void)
{
	vec4 background=par[1],hightlight=par[2];
	
	gl_FragDepth=par[3].z;
	switch(pass_info.method_id){
	case 1:
		frag_data[0]=code_integer(component_info.component_id);	//component_id
		frag_data[1]=frag_data[0];								//body_id
		frag_data[2]=frag_data[0];								//face_id
		frag_data[3]=frag_data[0];								//vertex_id
		break;
	case 2:
		frag_data[0]=code_integer(component_info.component_id);	//loop_id
		frag_data[1]=frag_data[0];								//edge_id
		frag_data[2]=code_float(frag_texture.x);				//depth
		frag_data[3]=code_float(frag_texture.y);				//value
		break;
	default:
		frag_data[0]=texture(texture_sampler,frag_texture.xy);
		if(frag_data[0].w<0.1)
				discard;
		else if(length(frag_data[0].rgb-background.rgb)<background.a)
				discard;
		else if(system_info.millisecond<500)
				if(frag_texture.x>hightlight.x)
					if(frag_texture.x<hightlight.z)
						if(frag_texture.y>hightlight.y)
							if(frag_texture.y<hightlight.w)
								discard;
		break;
	}
}