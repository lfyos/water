[
	
],

function (	method_id,			pass_id,				parameter_channel_id,	render_id,	part_id,
			render_buffer_id,	component_data_array,	project_matrix,			view_port,	do_render_number,
			render)
{
	var gl								=render.gl;
	var shader_object					=render.render_program.render_program[render_id];
	var shader_program					=shader_object.shader_program;
	var shader_data						=shader_object.shader_data;
	var part_buffer_object				=render.buffer_object.buffer_object[render_id][part_id];
	
	var component_location				=render.component_location_data;
	
	var data_buffer						=render.data_buffer[render_id][part_id];
	var pickup							=render.pickup;

	var permanent_render_id				=render.permanent_render_part_id[render_id][part_id].permanent_render_id;
	var permanent_part_id				=render.permanent_render_part_id[render_id][part_id].permanent_part_id;
	
	var part_information				=render.part_information[render_id][part_id].information;
	var part_material					=render.part_information[render_id][part_id].material;
	var part_property					=render.part_information[render_id][part_id].property;
	var part_component_id_and_driver_id	=render.part_information[render_id][part_id].part_component_id_and_driver_id;
	var instance_initialize_data		=render.part_information[render_id][part_id].instance_initialize_data;
	var part_initialize_data			=render.part_information[render_id][part_id].part_initialize_data;
	var render_initialize_data			=render.part_information[render_id][part_id].render_initialize_data;
	
	var clip_plane						=render.clip_plane_array[render_buffer_id];
	var clip_plane_matrix				=render.clip_plane_matrix_array[render_buffer_id];
	
	var camera_object_parameter			=render.camera.camera_object_parameter;
	var camera_render_parameter			=render.camera.camera_render_parameter[render_buffer_id];
	var camera_id						=camera_render_parameter.camera_id;
	var camera_component_id				=camera_object_parameter[camera_id].component_id;
	
	var utility							=render.utility;
	var computer						=render.computer;
	var current_time					=render.current_time;
	var modifier_current_time			=render.modifier_current_time;
	
	
	
	
	if(method_id!=0)
		return;
		
	function send_to_webserver(component_id,event_operation,render)
	{
		var ep=render.component_event_processor[component_id];
		var operate_component_id=((ep.function_id>=200)&&(ep.selected_component_id>=0))
					?(ep.selected_component_id):(render.current.camera_component_id);
		render.call_server_component(component_id,0,
			[
				["event_operation",		event_operation],
				["operate_component_id",operate_component_id]
			],
			function(response_data)
			{
				if(event_operation=="mousedown")
					ep.selected_component_id=response_data;
			});
	}
	function send_location_to_webserver(command_str,component_id,render,do_delay_flag)
	{
		var ep=render.component_event_processor[component_id];
		var operate_component_id=((ep.function_id>=200)&&(ep.selected_component_id>=0))
					?(ep.selected_component_id):(render.current.camera_component_id);
		var current_time=(new Date()).getTime();
		if(do_delay_flag)
			if((current_time-ep.send_mousemove_time)<render.modifier_time_parameter.delay_time_length)
				return;
		ep.send_mousemove_time=current_time;

		var str="";
					
		str+="&distance="		+(camera_object_parameter[render.current.camera_id].distance.toString());
		str+="&half_fovy_tanl=" +(camera_object_parameter[render.current.camera_id].half_fovy_tanl.toString());
					
		str+="&data=";
		
		var move_loca=component_location.get_one_component_location(operate_component_id);
		for(var i=0,ni=move_loca.length;i<ni;i++)
			str+=((i==0)?"":",")+(move_loca[i].toString());

		if(typeof(ep.clip_plane_modification)=="undefined")
			ep.clip_plane_modification=0.0;
	
		str+="&clip_plane_modification="+ep.clip_plane_modification.toString();
		ep.clip_plane_modification=0.0;
		
		send_to_webserver(component_id,command_str+str,render);
	}
	function world_point_modifier(component_id,world_point_0,world_point_1)
	{
		var ep							=render.component_event_processor[component_id];
		var camera_component_location	=component_location.get_component_location(render.current.camera_component_id);
		var center_point				=computer.caculate_coordinate(camera_component_location,0,0,0);
		var	selected_component_location	=camera_component_location;

		var p,p0,p1;
		var pl,matrix;
		
		if(ep.selected_component_id>=0)
			selected_component_location=component_location.get_component_location(ep.selected_component_id);
		
		switch(ep.function_id%100){
		case 2:
			pl		=computer.create_plane_from_two_point(center_point,computer.add_operation(center_point,[1,0,0,1]));
			matrix	=computer.project_to_plane_location(pl[0],pl[1],pl[2],pl[3],1.0);
			return	[	computer.caculate_coordinate(matrix,world_point_0[0],world_point_0[1],world_point_0[2]),
						computer.caculate_coordinate(matrix,world_point_1[0],world_point_1[1],world_point_1[2])
					];
		case 3:
		case 50:
		case 51:
			pl		=computer.create_plane_from_two_point(center_point,computer.add_operation(center_point,[0,1,0,1]));
			matrix	=computer.project_to_plane_location(pl[0],pl[1],pl[2],pl[3],1.0);
			return	[	computer.caculate_coordinate(matrix,world_point_0[0],world_point_0[1],world_point_0[2]),
						computer.caculate_coordinate(matrix,world_point_1[0],world_point_1[1],world_point_1[2])
					];
		case 4:
			pl		=computer.create_plane_from_two_point(center_point,computer.add_operation(center_point,[0,0,1,1]));
			matrix	=computer.project_to_plane_location(pl[0],pl[1],pl[2],pl[3],1.0);
			return	[	computer.caculate_coordinate(matrix,world_point_0[0],world_point_0[1],world_point_0[2]),
						computer.caculate_coordinate(matrix,world_point_1[0],world_point_1[1],world_point_1[2])
					];
		case 5:
			p=computer.sub_operation(
					computer.caculate_coordinate(selected_component_location,1,0,0),
					computer.caculate_coordinate(selected_component_location,0,0,0));
			pl		=computer.create_plane_from_two_point(center_point,computer.add_operation(center_point,p));
			matrix	=computer.project_to_plane_location(pl[0],pl[1],pl[2],pl[3],1.0);
			return	[	computer.caculate_coordinate(matrix,world_point_0[0],world_point_0[1],world_point_0[2]),
						computer.caculate_coordinate(matrix,world_point_1[0],world_point_1[1],world_point_1[2])
					];
		case 6:
			p=computer.sub_operation(
					computer.caculate_coordinate(selected_component_location,0,1,0),
					computer.caculate_coordinate(selected_component_location,0,0,0));
			pl		=computer.create_plane_from_two_point(center_point,computer.add_operation(center_point,p));
			matrix	=computer.project_to_plane_location(pl[0],pl[1],pl[2],pl[3],1.0);
			return	[	computer.caculate_coordinate(matrix,world_point_0[0],world_point_0[1],world_point_0[2]),
						computer.caculate_coordinate(matrix,world_point_1[0],world_point_1[1],world_point_1[2])
					];
		case 7:
			p=computer.sub_operation(
					computer.caculate_coordinate(selected_component_location,0,0,1),
					computer.caculate_coordinate(selected_component_location,0,0,0));
			pl		=computer.create_plane_from_two_point(center_point,computer.add_operation(center_point,p));
			matrix	=computer.project_to_plane_location(pl[0],pl[1],pl[2],pl[3],1.0);
			return	[	computer.caculate_coordinate(matrix,world_point_0[0],world_point_0[1],world_point_0[2]),
						computer.caculate_coordinate(matrix,world_point_1[0],world_point_1[1],world_point_1[2])
					];
		case 8:
			matrix			=computer.matrix_negative(camera_component_location);
			world_point_0	=computer.caculate_coordinate(matrix,world_point_0[0],world_point_0[1],world_point_0[2]);
			world_point_1	=computer.caculate_coordinate(matrix,world_point_1[0],world_point_1[1],world_point_1[2]);
			world_point_0[1]=0;
			world_point_1[1]=0;
			matrix			=camera_component_location;
			world_point_0	=computer.caculate_coordinate(matrix,world_point_0[0],world_point_0[1],world_point_0[2]);
			world_point_1	=computer.caculate_coordinate(matrix,world_point_1[0],world_point_1[1],world_point_1[2]);
			return [world_point_0,world_point_1];
		case 9:
			matrix			=computer.matrix_negative(camera_component_location);
			world_point_0	=computer.caculate_coordinate(matrix,world_point_0[0],world_point_0[1],world_point_0[2]);
			world_point_1	=computer.caculate_coordinate(matrix,world_point_1[0],world_point_1[1],world_point_1[2]);
			world_point_0[0]=0;
			world_point_1[0]=0;
			matrix			=camera_component_location;
			world_point_0	=computer.caculate_coordinate(matrix,world_point_0[0],world_point_0[1],world_point_0[2]);
			world_point_1	=computer.caculate_coordinate(matrix,world_point_1[0],world_point_1[1],world_point_1[2]);
			return [world_point_0,world_point_1];
		case 10:
			p=computer.sub_operation(
					computer.caculate_coordinate(camera_component_location,0,0,1),
					computer.caculate_coordinate(camera_component_location,0,0,0));
			pl		=computer.create_plane_from_two_point(center_point,computer.add_operation(center_point,p));
			matrix	=computer.project_to_plane_location(pl[0],pl[1],pl[2],pl[3],1.0);
			return	[	computer.caculate_coordinate(matrix,world_point_0[0],world_point_0[1],world_point_0[2]),
						computer.caculate_coordinate(matrix,world_point_1[0],world_point_1[1],world_point_1[2])
					];
		case 11:
			world_point_0[1]=world_point_1[1];
			world_point_0[2]=world_point_1[2];
			return [world_point_0,world_point_1];
		case 12:
			world_point_0[0]=world_point_1[0];
			world_point_0[2]=world_point_1[2];
			return [world_point_0,world_point_1];
		case 13:
			world_point_0[0]=world_point_1[0];
			world_point_0[1]=world_point_1[1];
			return [world_point_0,world_point_1];
		case 14:
			matrix			=computer.matrix_negative(selected_component_location);
			world_point_0	=computer.caculate_coordinate(matrix,world_point_0[0],world_point_0[1],world_point_0[2]);
			world_point_1	=computer.caculate_coordinate(matrix,world_point_1[0],world_point_1[1],world_point_1[2]);
			world_point_0[1]=world_point_1[1];
			world_point_0[2]=world_point_1[2];
			matrix			=selected_component_location;
			world_point_0	=computer.caculate_coordinate(matrix,world_point_0[0],world_point_0[1],world_point_0[2]);
			world_point_1	=computer.caculate_coordinate(matrix,world_point_1[0],world_point_1[1],world_point_1[2]);
			return [world_point_0,world_point_1];
		case 15:
			matrix			=computer.matrix_negative(selected_component_location);
			world_point_0	=computer.caculate_coordinate(matrix,world_point_0[0],world_point_0[1],world_point_0[2]);
			world_point_1	=computer.caculate_coordinate(matrix,world_point_1[0],world_point_1[1],world_point_1[2]);
			world_point_0[0]=world_point_1[0];
			world_point_0[2]=world_point_1[2];
			matrix			=selected_component_location;
			world_point_0	=computer.caculate_coordinate(matrix,world_point_0[0],world_point_0[1],world_point_0[2]);
			world_point_1	=computer.caculate_coordinate(matrix,world_point_1[0],world_point_1[1],world_point_1[2]);
			return [world_point_0,world_point_1];
		case 16:
			matrix			=computer.matrix_negative(selected_component_location);
			world_point_0	=computer.caculate_coordinate(matrix,world_point_0[0],world_point_0[1],world_point_0[2]);
			world_point_1	=computer.caculate_coordinate(matrix,world_point_1[0],world_point_1[1],world_point_1[2]);
			world_point_0[0]=world_point_1[0];
			world_point_0[1]=world_point_1[1];
			matrix			=selected_component_location;
			world_point_0	=computer.caculate_coordinate(matrix,world_point_0[0],world_point_0[1],world_point_0[2]);
			world_point_1	=computer.caculate_coordinate(matrix,world_point_1[0],world_point_1[1],world_point_1[2]);
			return [world_point_0,world_point_1];
		default:
			return [world_point_0,world_point_1];
		}
	}
	function camera_move(ep,world_point_0,world_point_1)
	{
		var camera_component_location	=component_location.get_component_location(render.current.camera_component_id);
		var loca			=computer.matrix_negative(camera_component_location);
		var local_point_0	=computer.caculate_coordinate(loca,world_point_0[0],world_point_0[1],world_point_0[2]);
		var local_point_1	=computer.caculate_coordinate(loca,world_point_1[0],world_point_1[1],world_point_1[2]);
		var diff			=computer.sub_operation(local_point_1,local_point_0);
			loca			=computer.create_move_rotate_matrix(diff[0],diff[1],diff[2],0,0,0);
		
		var move_loca		=component_location.get_one_component_location(render.current.camera_component_id);
			move_loca		=computer.matrix_multiplication(move_loca,loca);
		component_location.modify_one_component_location(render.current.camera_component_id,move_loca);
		
		return true;
	}
	function component_move(ep,world_point_0,world_point_1)
	{
		if(ep.selected_component_id<0)
			return false;
		var global_loca		=component_location.get_component_location(ep.selected_component_id);
		var	local_loca		=computer.matrix_negative(global_loca);
		var local_point_0	=computer.caculate_coordinate(local_loca,world_point_0[0],world_point_0[1],world_point_0[2]);
		var local_point_1	=computer.caculate_coordinate(local_loca,world_point_1[0],world_point_1[1],world_point_1[2]);
		var modify_loca		=computer.create_move_rotate_matrix(	local_point_0[0]-local_point_1[0],
								local_point_0[1]-local_point_1[1],	local_point_0[2]-local_point_1[2],0,0,0);
		
		var move_loca		=component_location.get_one_component_location(ep.selected_component_id);
		var	new_move_loca	=computer.matrix_multiplication(move_loca,modify_loca);
			
		component_location.modify_one_component_location(ep.selected_component_id,new_move_loca);
		
		return true;
	}
	
	function left_location_for_rotation(world_point_0,world_point_1,center_point)
	{
		var diff;
		
		var world_dir_0		=computer.expand_operation(computer.sub_operation(world_point_0,center_point),1.0);
		var world_dir_1		=computer.expand_operation(computer.sub_operation(world_point_1,center_point),1.0);
			world_point_0	=computer.add_operation(center_point,world_dir_0);
			world_point_1	=computer.add_operation(center_point,world_dir_1);

		diff=computer.sub_operation(world_point_0,world_point_1);
		if(computer.dot_operation(diff,diff)<computer.min_value2())
			return null;
		diff=computer.sub_operation(center_point,world_point_0);
		if(computer.dot_operation(diff,diff)<computer.min_value2())
			return null;
		diff=computer.sub_operation(center_point,world_point_1);
		if(computer.dot_operation(diff,diff)<computer.min_value2())
			return null;
		
		var aix_dir			=computer.expand_operation(computer.cross_operation(world_dir_0,world_dir_1),1.0);
		var aix_point		=computer.add_operation(center_point,aix_dir);
		
		var right_dir_0		=computer.expand_operation(computer.cross_operation(aix_dir,world_dir_0),1.0);
		var right_point_0	=computer.add_operation(center_point,right_dir_0);
		
		var right_dir_1		=computer.expand_operation(computer.cross_operation(aix_dir,world_dir_1),1.0);
		var right_point_1	=computer.add_operation(center_point,right_dir_1);

		var loca_0			=computer.create_point_location(center_point,aix_point,world_point_0,right_point_0);
		var loca_1			=computer.create_point_location(center_point,aix_point,world_point_1,right_point_1);
		
		return	computer.matrix_multiplication(loca_1,computer.matrix_negative(loca_0));
	}
	
	function camera_rotate(ep,world_point_0,world_point_1,center_point)
	{
		var left_adjust;
		
		if((left_adjust=left_location_for_rotation(world_point_0,world_point_1,center_point))==null)
			return false;
			
		var camera_component_location	=component_location.get_component_location(render.current.camera_component_id);
		var new_location				=computer.matrix_multiplication(left_adjust,camera_component_location);
		var loca						=computer.matrix_multiplication(
											computer.matrix_negative(camera_component_location),new_location);
		var move_loca					=component_location.get_one_component_location(render.current.camera_component_id);
		move_loca						=computer.matrix_multiplication(move_loca,loca);
		component_location.modify_one_component_location(render.current.camera_component_id,move_loca);
		return true;
	}
	
	function component_rotate(ep,world_point_0,world_point_1,center_point)
	{
		var left_adjust;
		
		if(ep.selected_component_id<0)
			return false;

		if((left_adjust=left_location_for_rotation(world_point_0,world_point_1,center_point))==null)
			return false;
			
		var	selected_component_location	=component_location.get_component_location(ep.selected_component_id);
			
		var new_location	=computer.matrix_multiplication(left_adjust,selected_component_location);
		var loca			=computer.matrix_multiplication(
								computer.matrix_negative(selected_component_location),new_location);
		var move_loca		=component_location.get_one_component_location(ep.selected_component_id);
		move_loca			=computer.matrix_multiplication(move_loca,computer.matrix_negative(loca));
		component_location.modify_one_component_location(ep.selected_component_id,move_loca);
		
		return true;
	}
	
	function change_matrix(component_id,vp_0,vp_1)
	{
		var ep=render.component_event_processor[component_id];
		var camera_distance	=camera_object_parameter[render.current.camera_id].distance;
		var half_fovy_tanl=camera_object_parameter[render.current.camera_id].half_fovy_tanl;
		var project_matrix	=render.camera.compute_camera_data(render.current.render_buffer_id);
		
		var camera_component_location=component_location.get_component_location(render.current.camera_component_id);
		var center_point	=computer.caculate_coordinate(camera_component_location,0,0,0);
		var eye_point		=computer.caculate_coordinate(camera_component_location,0,0,camera_distance);
				
		switch(ep.function_id%100){
		case 0:
			vp_1=computer.sub_operation(vp_1,vp_0);
			vp_0=[0,0,0,1];
			break;
		default:
			break;
		}		
		
		var world_point,world_point_0,world_point_1,view_mix_point,world_point_diff;
		
		switch(Math.floor(ep.function_id/100)){
		default:
			return;
		case 0:
		case 2:
			if(ep.rotate_type_flag){
				var middle_point=computer.caculate_coordinate(camera_component_location,0,0,camera_distance/2.0);
				view_mix_point	=computer.caculate_coordinate(project_matrix.matrix,middle_point[0],middle_point[1],middle_point[2]);
				world_point_0	=computer.caculate_coordinate(project_matrix.negative_matrix,vp_0[0],vp_0[1],view_mix_point[2]);
				world_point_1	=computer.caculate_coordinate(project_matrix.negative_matrix,vp_1[0],vp_1[1],view_mix_point[2]);
				world_point_diff=computer.sub_operation(world_point_1,world_point_0);
				world_point_diff=computer.scale_operation(world_point_diff,ep.mouse_rotate_scale/half_fovy_tanl);
				world_point_1	=computer.add_operation(world_point_0,world_point_diff);
				break;
			}
		case 1:
		case 3:
			view_mix_point	=computer.caculate_coordinate(project_matrix.matrix,center_point[0],center_point[1],center_point[2]);
			world_point_0	=computer.caculate_coordinate(project_matrix.negative_matrix,vp_0[0],vp_0[1],view_mix_point[2]);
			world_point_1	=computer.caculate_coordinate(project_matrix.negative_matrix,vp_1[0],vp_1[1],view_mix_point[2]);
			break;
		}
	
		world_point	=world_point_modifier(component_id,world_point_0,world_point_1);
		world_point_0	=world_point[0];
		world_point_1	=world_point[1];

		switch(Math.floor(ep.function_id/100)){
		case 0:
			if(ep.rotate_type_flag)
				camera_rotate(ep,world_point_0,world_point_1,center_point);
			else if(ep.exchange_point_flag)
				camera_rotate(ep,world_point_1,world_point_0,eye_point);
			else
				camera_rotate(ep,world_point_0,world_point_1,eye_point);
			break;
		case 1:
			if(ep.rotate_type_flag)
				camera_move(ep,world_point_0,world_point_1);
			else if(ep.exchange_point_flag)
				camera_move(ep,world_point_1,world_point_0);
			else
				camera_move(ep,world_point_0,world_point_1);
			break;
		case 2:
			if(ep.rotate_type_flag)
				component_rotate(ep,world_point_0,world_point_1,center_point);
			else if(ep.exchange_point_flag)
				component_rotate(ep,world_point_1,world_point_0,eye_point);
			else
				component_rotate(ep,world_point_0,world_point_1,eye_point);
			break;
		case 3:
			if(ep.rotate_type_flag)
				component_move(ep,world_point_0,world_point_1);
			else if(ep.exchange_point_flag)
				component_move(ep,world_point_1,world_point_0);
			else
				component_move(ep,world_point_0,world_point_1);
			break;
		default:
			break;
		}
	}
	
	function mousedown(event,component_id,render)
	{
		render.call_server_component(part_initialize_data.movement_component_name,"all",
			[["operation","virtual_mount"],["virtual_mount","terminate_follow"]]);

		var ep=render.component_event_processor[component_id];
		switch(event.button){
		case 0:
			var pinpoint=utility.get_pinpoint();
			if(pinpoint==null)
				break;
			ep.mouse_up_flag=false;
			ep.last_point=[pinpoint.x,pinpoint.y,0,1];
			send_to_webserver(component_id,"mousedown",render);
			return;
		case 2:	
			if(event.ctrlKey||event.shiftKey||event.altKey){
				var value;
				if(render.pickup.component_id>=0)
					if((value=prompt("ÊäÈë±ê×¢ÎÄ×Ö"))!=null)
						if((value=value.trim()).length>0)
							render.call_server_component(part_initialize_data.mark_component_name,"all",
								[["operation","append"],["value",encodeURIComponent(encodeURIComponent(value))]]);
			}else{
				render.call_server_component(part_initialize_data.movement_component_name,"all",
					[["operation","design"],["move_method","listdesignbuffer"]],
					function(response_data,render)
					{
						if(response_data.movement.length>0){
							var p=part_initialize_data.movement_abstract_menu_component_name;
							if((p=render.get_component_object_by_component_name(p))!=null){
								var my_component_id=p.component_id;
								p=render.component_event_processor[my_component_id];
								p.active_list(response_data,my_component_id,render);
							}
						}
					});
			}
			return;
		default:
			return;
		}
	}
	function mouseup(event,component_id,render)
	{
		var ep=render.component_event_processor[component_id];		
		switch(event.button){
		case 0:
			ep.mouse_up_flag=true;
			send_location_to_webserver("mouseup",ep.component_id,render,false);
			return;
		case 2:
			return;
		default:
			return;
		}
	}
	
	function mousemove(event,component_id,render)
	{
		var ep=render.component_event_processor[component_id];
		if(ep.mouse_up_flag)
			return;
		var pinpoint=utility.get_pinpoint();
		if(pinpoint==null)
			return;
		var dx=pinpoint.x-ep.last_point[0];
		var dy=pinpoint.y-ep.last_point[1];
		if(render.computer.min_value2()>=(dx*dx+dy*dy))
			return;
		var this_point=[pinpoint.x,pinpoint.y,0,1];
		
		if(ep.key_flag)
			ep.last_point=[
					this_point[0]+ep.low_precision_scale*(ep.last_point[0]-this_point[0]),
					this_point[1]+ep.low_precision_scale*(ep.last_point[1]-this_point[1]),
					0,1
			];
			
		change_matrix(component_id,this_point,ep.last_point);
		ep.last_point=this_point;
		
		send_location_to_webserver("mousemove",ep.component_id,render,true);
		
		return;
	}
	function dblclick(event,component_id,render)
	{
		if(event.button!=0)
			return;
		send_to_webserver(component_id,"dblclick",render);
	}
	function mousewheel(event,component_id,render)
	{
		var ep=render.component_event_processor[component_id],mouse_wheel_number=0;

		var camera_component_id	=render.current.camera_component_id;
		ep.move_loca			=component_location.component[camera_component_id].move_matrix;
	
		if(typeof(event.wheelDelta)=="number")
				mouse_wheel_number+=event.wheelDelta/2000.0;			//for chrome,opera
		else if(typeof(event.detail)=="number")
				mouse_wheel_number-=event.detail/50.0;					//for firefox
		else
				return;		

		if(ep.key_flag)
			mouse_wheel_number*=ep.low_precision_scale;

		if(ep.change_type_flag)
			camera_object_parameter[render.current.camera_id].distance		 /=Math.exp(mouse_wheel_number);
		else
			camera_object_parameter[render.current.camera_id].half_fovy_tanl/=Math.exp(mouse_wheel_number);

		send_location_to_webserver("mousemove",ep.component_id,render,true);
	}
	function mobile_phone(event,component_id,render)
	{
		event.preventDefault();
		
		var ep=render.component_event_processor[component_id];
		
		var x0,y0,x1,y1,dx,dy,btn=render.canvas;
		
		switch(event.touches.length){
		case 0:
			switch(event.type){
			default:
			case "touchmove":
			case "touchstart":
				break;	
			case "touchend":
				ep.mouse_up_flag=true;
				send_location_to_webserver("mouseup",component_id,render,false);
				send_to_webserver(component_id,"touchend",render);
				render.view.x=0.0;
				render.view.y=0.0;
				break;
			}
			break;
		case 1:	
			x1=event.touches[0].clientX-btn.offsetLeft;
			y1=btn.clientHeight-(event.touches[0].clientY-btn.offsetTop);	
			x1=2.0*((x1/btn.clientWidth )-0.5);
			y1=2.0*((y1/btn.clientHeight)-0.5);
			
			switch(event.type){
			case "touchstart":
				ep.mouse_up_flag=false;
				ep.last_point=[x1,y1,0,1];
				send_to_webserver(component_id,"mousedown",render);
				break;
			case "touchmove":
				if(ep.mouse_up_flag)
					break;
				dx=x1-ep.last_point[0];
				dy=y1-ep.last_point[1];	
				if(render.computer.min_value2()>=(dx*dx+dy*dy))
					break;
				
				change_matrix(component_id,[x1,y1,0,1],ep.last_point);
				
				ep.last_point=[x1,y1,0,1];
				send_location_to_webserver("mousemove",ep.component_id,render,true);
				break;
			}
			break;
		case 2:
			x1=event.touches[1].clientX-btn.offsetLeft;
			y1=btn.clientHeight-(event.touches[1].clientY-btn.offsetTop);	
			x1=2.0*((x1/btn.clientWidth )-0.5);
			y1=2.0*((y1/btn.clientHeight)-0.5);
			
			x0=event.touches[0].clientX-btn.offsetLeft;
			y0=btn.clientHeight-(event.touches[0].clientY-btn.offsetTop);	
			x0=2.0*((x0/btn.clientWidth )-0.5);
			y0=2.0*((y0/btn.clientHeight)-0.5);
			
			dx=x1-x0;
			dy=y1-y0;
			
			switch(event.type){
			case "touchmove":
				var mouse_wheel_number=0.125*Math.log((dx*dx+dy*dy)/(ep.touchstart_distance_2));
				if(ep.change_type_flag)
					camera_object_parameter[render.current.camera_id].distance		 /=Math.exp(mouse_wheel_number);
				else
					camera_object_parameter[render.current.camera_id].half_fovy_tanl/=Math.exp(mouse_wheel_number);
				send_location_to_webserver("mousemove",ep.component_id,render,false);
			case "touchstart":
				ep.touchstart_distance_2=dx*dx+dy*dy;
				break;
			}
			break;
		}
		return false;		
	}
	function keydown(event,component_id,render)
	{
		var ep=render.component_event_processor[component_id];
		switch(event.keyCode){
		case 13:	//enter
			break;
		case 16:	//shift
		case 17:	//control
		case 18:	//alt
			ep.key_flag=true;
			break;
		case 37:	//left arrow
			break;
		case 38:	//up arrow
			break;
		case 39:	//right arrow
			break;
		case 40:	//down arrow
			break;
		case 107:	//+
			break;
		case 109:	//-
			break;
		default:
			break;
		};
	};
	function keyup(event,component_id,render)
	{
		var ep=render.component_event_processor[component_id];
		switch(event.keyCode){
		case 16:	//shift
		case 17:	//control
		case 18:	//alt
			ep.key_flag=false;
			break;
		case 37:	//left arrow
			break;
		case 38:	//up arrow
			break;
		case 39:	//right arrow
			break;
		case 40:	//down arrow
			break;
		case 107:	//+
			break;
		case 109:	//-
			break;
		default:
			break;
		}
	};
	function set_event_component(my_component_id,my_render)
	{
		var ep=my_render.component_event_processor[my_component_id];
		ep.function_id		=my_render.event_component.mouse.function_id;
		ep.bak_function_id	=my_render.event_component.mouse.function_id;
		ep.selected_component_id=-1;
	};
	for(var i=0,n=component_data_array.length;i<n;i++){
		var buffer_id			=component_data_array[i];
		
		while(data_buffer[buffer_id].length>1)
			data_buffer[buffer_id].shift();
		
		var buffer_data			=data_buffer[buffer_id][0];
		
		var component_id		=buffer_data[0];
		var low_precision_scale	=buffer_data[1];
		var mouse_rotate_scale	=buffer_data[2];
		var rotate_type_flag	=(buffer_data[3]>0.5)?true:false;
		var change_type_flag	=(buffer_data[4]>0.5)?true:false;
		var exchange_point_flag	=(buffer_data[5]>0.5)?true:false;
		
		var ep=render.component_event_processor[component_id];
		
		if(typeof(ep)=="undefined"){
		
			ep=new Object();

			ep.send_mousemove_time		=0;
			
			ep.mouse_up_flag			=true;
			ep.selected_component_id	=-1;
			
			ep.mousedown	=mousedown;
			ep.mouseup		=mouseup;
			ep.mousemove	=mousemove;
			ep.dblclick		=dblclick;
			ep.mousewheel	=mousewheel;
			
			ep.touchstart	=mobile_phone;
			ep.touchend		=mobile_phone;
			ep.touchmove	=mobile_phone;

			ep.keydown		=keydown;
			ep.keyup		=keyup;
			ep.key_flag		=false;

			ep.set_event_component=set_event_component;

			ep.last_point=[0,0,0,1];
			ep.touchstart_distance_2=1.0;
			
			ep.function_id		=0;
			ep.bak_function_id	=0;
			ep.selected_component_id=-1;
			
			ep.start_time=(new Date()).getTime();
			
			render.component_event_processor[component_id]=ep;
		}
		ep.component_id			=component_id;
		ep.low_precision_scale	=low_precision_scale;
		ep.mouse_rotate_scale	=mouse_rotate_scale;
		ep.rotate_type_flag		=rotate_type_flag;
		ep.change_type_flag		=change_type_flag;
		ep.exchange_point_flag	=exchange_point_flag;
	}
}